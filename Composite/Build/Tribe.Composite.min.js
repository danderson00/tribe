"undefined"==typeof T&&(T={}),function(){var e=4,t={debug:4,info:3,warn:2,error:1,none:0},n={setLevel:function(n){e=t[n],void 0===e&&(e=4)},debug:function(t){e>=4&&console.log("DEBUG: "+t)},info:function(t){e>=3&&console.info("INFO: "+t)},warn:function(t){e>=2&&console.warn("WARN: "+t)},error:function(t,n){e>=1&&console.error("ERROR: "+t,n)}};n.log=n.debug,"undefined"!=typeof exports&&"undefined"!=typeof module?module.exports=n:T.logger=n}(),window.Tribe=window.Tribe||{},Tribe.PubSub=function(e){function t(e){function t(t){var n=i("exceptionHandler");if(i("handleExceptions"))try{t(e.data,e)}catch(a){n&&n(a,e)}else t(e.data,e)}for(var n=o.get(e.topic),r=e.sync===!0||a.sync===!0,s=0,l=n.length;l>s;s++)r?t(n[s].handler):!function(e){setTimeout(function(){t(e.handler)})}(n[s])}function n(e,t){return e&&e.topic?e:{topic:e,data:t}}function i(t){return e&&e.hasOwnProperty(t)?e[t]:Tribe.PubSub.options[t]}var a=this,r=Tribe.PubSub.utils;this.owner=this,this.sync=i("sync");var o=new Tribe.PubSub.SubscriberList;this.subscribers=o,this.publish=function(e,i){return t(n(e,i))},this.publishSync=function(e,i){var a=n(e,i);return a.sync=!0,t(a)},this.subscribe=function(e,t){return"string"==typeof e?o.add(e,t):r.isArray(e)?r.map(e,function(e){return o.add(e,t)}):r.map(e,function(e,t){return o.add(t,e)})},this.unsubscribe=function(e){if(Tribe.PubSub.utils.isArray(e)){for(var t=[],n=0,i=e.length;i>n;n++)t.push(o.remove(e[n]));return t}return o.remove(e)},this.createLifetime=function(){return new Tribe.PubSub.Lifetime(a,a)},this.channel=function(e){return new Tribe.PubSub.Channel(a,e)}},Tribe.PubSub.Channel=function(e,t){function n(e,n){var i=e&&e.topic?e:{topic:e,data:n};return i.channelId=t,i}function i(e){return function(n,i){i.channelId===t&&e(n,i)}}e=e.createLifetime(),this.id=t,this.publish=function(t,i){return e.publish(n(t,i))},this.publishSync=function(t,i){return e.publishSync(n(t,i))},this.subscribe=function(t,n){return e.subscribe(t,i(n))},this.subscribeOnce=function(t,n){return e.subscribeOnce(t,i(n))},this.unsubscribe=function(t){return e.unsubscribe(t)},this.end=function(){return e.end()}},Tribe.PubSub.Lifetime=function(e,t){function n(e){return Tribe.PubSub.utils.isArray(e)?a=a.concat(e):a.push(e),e}var i=this,a=[];this.owner=t,this.publish=function(t,n){return e.publish(t,n)},this.publishSync=function(t,n){return e.publishSync(t,n)},this.subscribe=function(t,i){var a=e.subscribe(t,i);return n(a)},this.subscribeOnce=function(t,i){var a=e.subscribeOnce(t,i);return n(a)},this.unsubscribe=function(t){return e.unsubscribe(t)},this.channel=function(e){return new Tribe.PubSub.Channel(i,e)},this.end=function(){return e.unsubscribe(a)},this.createLifetime=function(){return new Tribe.PubSub.Lifetime(i,i.owner)}},window.Tribe.PubSub.options={sync:!1,handleExceptions:!0,exceptionHandler:function(e,t){window.console&&console.log("Exception occurred in subscriber to '"+t.topic+"': "+e.message)}},Tribe.PubSub.Saga=function(e,t){function n(t,n){"onstart"!==n&&"onend"!==n&&(t?t.constructor===Function?e.subscribe(n,i(t)):e.subscribe(n,a(t)):e.subscribe(n,r()))}function i(e){return function(n,i){t.endsChildrenExplicitly||o(n),e(n,i,l)}}function a(e){return function(t){l.startChild({handles:e},t)}}function r(){return function(e){l.end(e)}}function o(e){Tribe.PubSub.utils.each(l.children,function(t){t.end(e)})}function s(e,t){if(e.constructor===Function){var n=[l].concat(t);e=d.applyToConstructor(e,n)}return e}var l=this,d=Tribe.PubSub.utils;e=e.createLifetime(),this.pubsub=e,this.children=[],t=s(t,Array.prototype.slice.call(arguments,2));var p=t.handles||{};this.start=function(e){return d.each(p,n),p.onstart&&p.onstart(e,l),l},this.startChild=function(t){return l.children.push(new Tribe.PubSub.Saga(e,s(t,Array.prototype.slice.call(arguments,1))).start()),l},this.end=function(t){return p.onend&&p.onend(t,l),e.end(),o(t),l}},Tribe.PubSub.Saga.startSaga=function(e){var t=[this,e].concat(Array.prototype.slice.call(arguments,1)),n=Tribe.PubSub.utils.applyToConstructor(Tribe.PubSub.Saga,t);return n.start()},Tribe.PubSub.prototype.startSaga=Tribe.PubSub.Saga.startSaga,Tribe.PubSub.Lifetime.prototype.startSaga=Tribe.PubSub.Saga.startSaga,Tribe.PubSub.prototype.subscribeOnce=function(e,t){function n(){var n={};return o.each(e,function(e){n[e]=a(t)}),n}function i(){return o.map(e,function(e,t){return s.subscribe(t,a(e))})}function a(e){return function(){s.end(),e.apply(r,arguments)}}var r=this,o=Tribe.PubSub.utils,s=this.createLifetime();return"string"==typeof e?s.subscribe(e,a(t)):o.isArray(e)?s.subscribe(n()):s.subscribe(i())},Tribe.PubSub.SubscriberList=function(){function e(e,t){if("*"===t)return!0;var n="^"+t.replace(/\./g,"\\.").replace(/\*/g,"[^.]*")+"$";return e.match(n)}var t={},n=-1;this.get=function(n){var i=[];for(var a in t)t.hasOwnProperty(a)&&e(n,a)&&(i=i.concat(t[a]));return i},this.add=function(e,i){var a=(++n).toString();return t.hasOwnProperty(e)||(t[e]=[]),t[e].push({topic:e,handler:i,token:a}),a},this.remove=function(e){for(var n in t)if(t.hasOwnProperty(n))for(var i=0,a=t[n].length;a>i;i++)if(t[n][i].token===e)return t[n].splice(i,1),e;return!1}},Tribe.PubSub.utils={},function(e){e.isArray=function(e){return e.constructor===Array},e.applyToConstructor=function(e,t){var n,i,a=function(){};return a.prototype=e.prototype,n=new a,i=e.apply(n,t),Object(i)===i?i:n};var t=Array.prototype.forEach,n=Array.prototype.map,i={};e.each=function(e,n,a){if(null!=e)if(t&&e.forEach===t)e.forEach(n,a);else if(e.length===+e.length){for(var r=0,o=e.length;o>r;r++)if(n.call(a,e[r],r,e)===i)return}else for(var s in e)if(e.hasOwnProperty(s)&&n.call(a,e[s],s,e)===i)return},e.map=function(t,i,a){var r=[];return null==t?r:n&&t.map===n?t.map(i,a):(e.each(t,function(e,t,n){r[r.length]=i.call(a,e,t,n)}),r)}}(Tribe.PubSub.utils),function(e){if("undefined"==typeof jQuery)throw"jQuery must be loaded before knockout.composite can initialise";if("undefined"==typeof ko)throw"knockout.js must be loaded before knockout.composite can initialise";if("undefined"==typeof T)throw"Tribe.Common must be loaded before knockout.composite can initialise";e.Tribe=e.Tribe||{},e.Tribe.Composite={},e.TC=e.Tribe.Composite,e.TC.Events={},e.TC.Factories={},e.TC.LoadHandlers={},e.TC.LoadStrategies={},e.TC.Transitions={},e.TC.Types={},e.TC.Utils={},e.TC.logger=T.logger,e.TC.pubsub=new Tribe.PubSub,$(function(){$("head").append('<style class="__tribe">.__rendering { position: fixed; top: -10000px; left: -10000px; }</style>')})}(window||this),TC.defaultOptions=function(){return{synchronous:!1,handleExceptions:!0,basePath:"",loadStrategy:"adhoc",events:["loadResources","createPubSub","createModel","initialiseModel","renderPane","renderComplete","active","dispose"]}},TC.options=TC.defaultOptions(),function(){function e(e){return{init:function(t,n){function r(t){t.which===e&&a(i.val())}var i=$(t),a=n();$.isFunction(a)&&i.keyup(r)}}}ko.bindingHandlers.cssClass={update:function(e,t){var n=t();n&&$(e).addClass(ko.utils.unwrapObservable(n))}},ko.bindingHandlers.enterPressed=e(13),ko.bindingHandlers.escapePressed=e(27)}(),function(e){e.each=function(e,t){return $.each(e||[],function(e,n){return t(n,e)})},e.map=function(t,n){var i=[];return e.each(t||[],function(e,t){i.push(n(e,t))}),i},e.filter=function(e,t){var n=[];return $.each(e||[],function(e,i){t(i,e)&&n.push(i)}),n},e.pluck=function(t,n){return e.map(t,function(e){return e&&e[n]})},e.reduce=function(t,n,i){return e.each(t,function(e,a){n=i(n,e,a,t)}),n}}(TC.Utils),TC.Utils.deparam=function(e,t){var n=decodeURIComponent,i={},a={"true":!0,"false":!1,"null":null};return $.each(e.replace(/\+/g," ").split("&"),function(e,r){var l,o=r.split("="),s=n(o[0]),d=i,p=0,c=s.split("]["),u=c.length-1;if(/\[/.test(c[0])&&/\]$/.test(c[u])?(c[u]=c[u].replace(/\]$/,""),c=c.shift().split("[").concat(c),u=c.length-1):u=0,2===o.length)if(l=n(o[1]),t&&(l=l&&!isNaN(l)?+l:"undefined"===l?void 0:void 0!==a[l]?a[l]:l),u)for(;u>=p;p++)s=""===c[p]?d.length:c[p],d=d[s]=u>p?d[s]||(c[p+1]&&isNaN(c[p+1])?{}:[]):l;else $.isArray(i[s])?i[s].push(l):i[s]=void 0!==i[s]?[i[s],l]:l;else s&&(i[s]=t?void 0:"")}),i},function(){function e(e,t,n){if(!e)throw"Can't embed property in falsy value";e["__"+t]=n}function t(e,t){return e&&e["__"+t]}TC.Utils.embedState=function(t,n,i){e(t,"context",n),e(t,"node",i)},TC.Utils.contextFor=function(e){return e&&TC.Utils.extractContext(ko.contextFor($(e)[0]))},TC.Utils.extractContext=function(e){return e&&t(e.$root,"context")},TC.Utils.extractNode=function(e){return e&&t(e.$root,"node")}}(),function(){TC.Utils.elementDestroyed=function(e){function n(t){t.target===e&&i()}function i(){$(e).off("destroyed",i),$(document).off("DOMNodeRemoved",n),t.resolve()}e.constructor===jQuery&&(e=e[0]);var t=$.Deferred();return $(e).on("destroyed",i),$(document).on("DOMNodeRemoved",n),t},TC.Utils.raiseDocumentEvent=function(e,t){var n=$.Event(e);n.eventData=t,$(document).trigger(n)};var e={};TC.Utils.handleDocumentEvent=function(t,n){function i(e){n(e.originalEvent||e)}$(document).on(t,i),e[n]=i},TC.Utils.detachDocumentEvent=function(t,n){$(document).off(t,e[n]),delete e[n]}}(),TC.Utils.tryCatch=function(e,t,n,i){if(n)try{e.apply(this,t||[])}catch(a){TC.logger.error(i,a)}else e.apply(this,t||[])},function(){TC.Utils.idGenerator=function(){return{next:function(){var e=0;return function(){return 0==arguments[0]?(e=1,0):e++}}()}};var e=TC.Utils.idGenerator();TC.Utils.getUniqueId=function(){return e.next()}}(),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){"use strict";if(null==this)throw new TypeError;var t,n,i=Object(this),a=i.length>>>0;if(0===a)return-1;if(t=0,arguments.length>1&&(t=Number(arguments[1]),t!=t?t=0:0!=t&&1/0!=t&&t!=-1/0&&(t=(t>0||-1)*Math.floor(Math.abs(t)))),t>=a)return-1;for(n=t>=0?t:Math.max(a-Math.abs(t),0);a>n;n++)if(n in i&&i[n]===e)return n;return-1}),function(e){e.complete=function(t){function r(t,i){n.push(e.Deferred(function(t){e.when(i).done(function(){a=!0}).always(function(){t.resolve()})}))}var n=[],i=e.Deferred(),a=!1;return e.isArray(t)?e.each(t,r):r(0,t),e.when.apply(e,n).done(function(){a?i.resolve():i.reject()}),i}}(jQuery),function(e){var t=jQuery.cleanData;e.cleanData=function(n){for(var a,i=0;void 0!==(a=n[i]);i++)e(a).triggerHandler("destroyed");t(n)}}(jQuery),TC.Utils.cleanElement=function(e){var t=$.cleanData;$.cleanData=void 0,ko.cleanNode(e),$.cleanData=t},TC.Utils.arguments=function(e){var t={};return $.each(e,function(e,n){t[n.constructor]=n}),{byConstructor:function(e){return t(e)},object:t[Object],string:t[String],func:t[Function],array:t[Array],number:t[Number]}},TC.Utils.removeItem=function(e,t){var n=$.inArray(t,e);n>-1&&e.splice(n,1)},TC.Utils.inheritOptions=function(e,t,n){for(var i=0,a=n.length;a>i;i++)t[n[i]]=e[n[i]];return t},TC.Utils.cloneData=function(e,t){if(e){var n={};for(var i in e){var a=e[i];!e.hasOwnProperty(i)||t&&-1!==Array.prototype.indexOf.call(arguments,i)||a&&a.constructor===Function&&!ko.isObservable(a)||(n[i]=ko.utils.unwrapObservable(a))}return n}},TC.Utils.normaliseBindings=function(e,t){var n=t();return n.value=e(),!ko.isObservable(n.value)&&$.isFunction(n.value)&&(n.value=n.value()),n},function(){var e=TC.Utils;e.getPaneOptions=function(e,t){var n=e.constructor===String?{path:e}:e;return $.extend({},t,n)},e.bindPane=function(t,n,i,a){a=a||e.contextFor(n)||TC.context();var r=new TC.Types.Pane($.extend({element:$(n)[0]},i));t.setPane(r),a.renderOperation.add(r);var o=new TC.Types.Pipeline(TC.Events,a);return o.execute(a.options.events,r),r},e.insertPaneAfter=function(t,n,i,a){var r=$("<div/>").insertAfter(n);return e.bindPane(t,r,i,a)}}(),function(){function e(t){function a(e){return e=r(e),e=o(e),e=s(e)}function r(e){var t=e.indexOf("://")>-1?e.indexOf("://")+3:0,n=e.substring(0,t),i=e.substring(t);return n+i.replace(/\/{2,}/g,"/")}function o(e){for(var t=/[^\/\.]+\/\.\.\//;e.match(t);)e=e.replace(t,"");return e}function s(e){var t=/\.\//g,n=e.lastIndexOf("../");return n=-1==n?0:n+3,e.substring(0,n)+e.substring(n).replace(t,"")}t=t?a(t.toString()):"";var n=t.lastIndexOf("/")+1,i=t.lastIndexOf(".");return{withoutFilename:function(){return e(t.substring(0,n))},filename:function(){return e(t.substring(n))},extension:function(){return-1===i?"":t.substring(i+1)},withoutExtension:function(){return e(-1===i?t:t.substring(0,i))},combine:function(n){return e((t?t+"/":"")+n.toString())},isAbsolute:function(){return"/"===t.charAt(0)||t.indexOf("://")>-1},makeAbsolute:function(){return e("/"+t)},makeRelative:function(){return e("/"===t.charAt(0)?t.substring(1):t)},asMarkupIdentifier:function(){return this.withoutExtension().toString().replace(/\//g,"-").replace(/\./g,"")},setExtension:function(t){return e(this.withoutExtension()+"."+t)},toString:function(){return t.toString()}}}TC.Path=e}(),function(){function e(e){return decodeURIComponent(e.replace(/\+/g," "))}function t(t){return function n(i,a){var r,o,s,l,d;return 2===arguments.length?(i=i.split(t),n(e(i.shift()),e(i.join(t)),!0)):(i=i.replace(/^\s+|\s+$/g,""),a.constructor===String&&(a=a.replace(/^\s+|\s+$/g,""),isNaN(a)||(o=+a,a===o.toString(10)&&(a=o))),(r=/(.*)\[([^\]]*)\]$/.exec(i))?(l=r[2],s=r[1],l?(d={},d[l]=a,n(s,d,!0)):n(s,[a],!0)):(d={},i&&(d[i]=a),d))}}function n(e,t){return e?$.isArray(e)?e.concat(t):$.isPlainObject(e)&&$.isPlainObject(t)?i(e,t):[e].concat(t):t}function i(e,t){for(var i in t)i&&t.hasOwnProperty(i)&&(e[i]=n(e[i],t[i]));return e}TC.Utils.Querystring=TC.Utils.Querystring||{},TC.Utils.Querystring.parse=function(e,i,a){function r(){e.length>0&&"?"===e.charAt(0)&&(e=e.substring(1))}return r(),TC.Utils.reduce(TC.Utils.map(e.split(i||"&"),t(a||"=")),{},n)}}(),function(){function t(n,i,a,r){i=i||{},r=r||[];var o,s,l,d,p,c,u=i.seperator||"&",b=i.eqSymbol||"=",h=i.arrayKey!==!1;if(null===n||void 0===n||n.constructor===Function)return a?e(a)+b:"";if((n.constructor===Boolean||"[object Boolean]"===Object.prototype.toString.call(n))&&(n=+n),!isNaN(n)||n.constructor===String)return e(a)+b+e(n);if($.isArray(n)){for(c=[],a=h?a+"[]":a,l=0,d=n.length;d>l;l++)c.push(t(n[l],i,a,r));return c.join(u)}for(l=r.length-1;l>=0;--l)if(r[l]===n)throw new Error("TC.Utils.Querystring.stringify: cyclical reference");r.push(n),c=[],o=a?a+"[":"",s=a?"]":"";for(l in n)n.hasOwnProperty(l)&&(p=o+l+s,c.push(t(n[l],i,p,r)));return r.pop(),c=c.join(u),!c&&a?a+"=":c}TC.Utils.Querystring=TC.Utils.Querystring||{};var e=encodeURIComponent;TC.Utils.Querystring.stringify=function(e,n){return t(e,n)}}(),function(){function e(e,t,n){if(t.constructor===Function){var i=[e].concat(n);t=Tribe.PubSub.utils.applyToConstructor(t,i)}return t}TC.Types.Flow=function(t,n){function r(){if(t.constructor===TC.Types.Node)return t.findNavigation().node;if(t.constructor===TC.Types.Pane)return t.node.findNavigation().node;throw new Error("navigationSource must be either TC.Types.Pane or TC.Types.Node")}var a=this;this.node=r(),this.pubsub=this.node.pane.pubsub.owner,this.sagas=[],n=e(a,n,Array.prototype.slice.call(arguments,2)),this.saga=new Tribe.PubSub.Saga(this.pubsub,n),this.start=function(e){return a.saga.start(e),a},this.end=function(e){return a.saga.end(e),TC.Utils.each(a.sagas,function(t){t.end(e)}),a}},TC.Types.Flow.prototype.startChild=function(t){return t=e(this,t,Array.prototype.slice.call(arguments,1)),this.saga.startChild(t),this},TC.Types.Flow.prototype.navigate=function(e,t){this.node.navigate(e,t)},TC.Types.Flow.prototype.startSaga=function(){var n=this.pubsub.startSaga.apply(this.pubsub,arguments);return this.sagas.push(n),n},TC.Types.Flow.prototype.to=function(e,t){var n=this.node;return function(){n.navigate(e,t)}},TC.Types.Flow.prototype.endsAt=function(e,t){var n=this;return function(){n.node.navigate(e,t),n.end()}},TC.Types.Flow.prototype.start=function(){var n=this,i=arguments;return function(){n.startChild.apply(n,i)}},TC.Types.Flow.startFlow=function(e){var n=[this,e].concat(Array.prototype.slice.call(arguments,1)),i=Tribe.PubSub.utils.applyToConstructor(TC.Types.Flow,n);return i.start()}}(),TC.Types.History=function(e){function a(e){null!==e.state&&i(e)}var t=0;e.replaceState(t,window.title);var n={raiseEvent:function(e){TC.Utils.raiseDocumentEvent("browser.go",{count:e.state-t}),t=e.state},updateStack:function(e){t=e.state,i=n.raiseEvent}},i=n.raiseEvent;window.addEventListener&&window.addEventListener("popstate",a),this.navigate=function(n){n=n||{},e.pushState(++t,n.title,n.url)},this.go=function(t){e.go(t)},this.update=function(t){i=n.updateStack,e.go(t)},this.dispose=function(){window.removeEventListener("popstate",a)}},TC.history=window.history.pushState?new TC.Types.History(window.history):new TC.Types.History({replaceState:function(){},pushState:function(){},go:function(){}}),TC.Types.Loader=function(){var t={};this.get=function(e,n,i){if(void 0!==t[e])return t[e];var a=TC.Path(e).extension().toString(),r=TC.LoadHandlers[a];if(r){var o=r(e,n,i);return t[e]=o,$.when(o).always(function(){t[e]=null}),o}return TC.logger.warn("Resource of type "+a+" but no handler registered."),null}},TC.Types.Models=function(){},TC.Types.Models.prototype.register=function(e,t,n){this[e]={constructor:t,options:n||{}},TC.logger.debug("Model loaded for "+e)},TC.Types.Navigation=function(e,t){function a(e){r(e.eventData.count)}function r(e){var t=i+e;0>t&&(t=0),t>=n.length&&(t=n.length-1),t!=i&&o(n[t],0>e),i=t}function o(n,i){TC.Utils.raiseDocumentEvent("navigating",{node:e,options:n,browserData:t.browserData}),e.transitionTo(n,t.transition,i)}function s(){n.splice(i+1,n.length)}function l(){t=t||{},t.constructor===String&&(t={transition:t}),t.browser===!0&&(t.browser=TC.options.defaultUrlProvider)}function d(){var n=window.location.href.match(/\#.*/);n&&(n=n[0].substring(1));var i=t.browser&&t.browser.paneOptionsFrom(n);i&&(e.pane.path=i.path,e.pane.data=i.data)}function p(){return{path:e.pane.path,data:e.pane.data}}l(),d();var n=[p()],i=0;this.node=e,this.stack=n,this.navigate=function(e){t.browser&&TC.history.navigate(t.browser&&t.browser.urlDataFrom(e)),s(),n.push(e),i++,o(e)},this.isAtStart=function(){return 0===i},this.go=function(e){r(e),t.browser&&TC.history.update(e)},t.browser&&TC.Utils.handleDocumentEvent("browser.go",a),this.dispose=function(){TC.Utils.detachDocumentEvent("browser.go",a)}},TC.Types.Node=function(e,t){this.parent=e,this.children=[],this.root=e?e.root:this,this.id=TC.Utils.getUniqueId(),e&&e.children.push(this),t&&this.setPane(t)},TC.Types.Node.prototype.navigate=function(e,t){var n=TC.Utils.getPaneOptions(e,{data:t});TC.Path(n.path).isAbsolute()||(n.path=TC.Path(this.nodeForPath().pane.path).withoutFilename().combine(n.path).toString()),this.findNavigation().navigate(n)},TC.Types.Node.prototype.navigateBack=function(){this.findNavigation().go(-1)},TC.Types.Node.prototype.findNavigation=function(){return this.defaultNavigation?this.defaultNavigation:this.navigation?this.navigation:this.parent?this.parent.findNavigation():(this.navigation=new TC.Types.Navigation(this),this.navigation)},TC.Types.Node.prototype.transitionTo=function(e,t,n){TC.transition(this,t,n).to(e)},TC.Types.Node.prototype.setPane=function(e){this.pane&&(this.pane.node=null),e.node=this,this.pane=e,this.skipPath=e.skipPath,e.handlesNavigation&&(this.navigation=new TC.Types.Navigation(this,e.handlesNavigation),this.root.defaultNavigation=this.root.defaultNavigation||this.navigation),e.inheritPathFrom(this.parent)},TC.Types.Node.prototype.nodeForPath=function(){return this.skipPath&&this.parent?this.parent.nodeForPath():this},TC.Types.Node.prototype.dispose=function(){this.root.defaultNavigation===this.navigation&&(this.root.defaultNavigation=null),this.parent&&TC.Utils.removeItem(this.parent.children,this),this.pane&&this.pane.dispose&&(delete this.pane.node,this.pane.dispose())},TC.Types.Node.prototype.startFlow=TC.Types.Flow.startFlow,TC.Types.Operation=function(){var e=this,t=[];this.promise=$.Deferred(),this.add=function(e){t.push(e)},this.complete=function(n){TC.Utils.removeItem(t,n),0===t.length&&e.promise.resolve()}},TC.Types.Pane=function(e){TC.Utils.inheritOptions(e,this,["path","data","element","transition","reverseTransitionIn","handlesNavigation","pubsub","id","skipPath"]),this.is={rendered:$.Deferred(),disposed:$.Deferred()}},TC.Types.Pane.prototype.navigate=function(e,t){this.node&&this.node.navigate(e,t)},TC.Types.Pane.prototype.navigateBack=function(){this.node&&this.node.navigateBack()},TC.Types.Pane.prototype.remove=function(){$(this.element).remove()},TC.Types.Pane.prototype.dispose=function(){this.model&&this.model.dispose&&this.model.dispose(),this.node&&(delete this.node.pane,this.node.dispose()),this.element&&TC.Utils.cleanElement(this.element)},TC.Types.Pane.prototype.inheritPathFrom=function(e){e=e&&e.nodeForPath();var t=e&&e.pane,n=TC.Path(this.path);this.path=n.isAbsolute()||!t?n.makeAbsolute().toString():TC.Path(t.path).withoutFilename().combine(n).toString()},TC.Types.Pane.prototype.find=function(e){return $(this.element).find(e)},TC.Types.Pane.prototype.startRender=function(){$(this.element).addClass("__rendering")},TC.Types.Pane.prototype.endRender=function(){$(this.element).removeClass("__rendering")},TC.Types.Pane.prototype.toString=function(){return"{ path: '"+this.path+"' }"},TC.Types.Pane.prototype.startFlow=TC.Types.Flow.startFlow,TC.Types.Pipeline=function(e,t){this.execute=function(n,i){function o(){function d(){r.reject();var e=i?i.toString():"empty target";TC.logger.error("An error occurred in the '"+s+"' event for "+e)}if(a++,a>=n.length)return r.resolve(),void 0;var s=n[a],l=e[s];return l?($.when(l(i,t)).done(o).fail(d),void 0):(TC.logger.warn("No event defined for "+s),o(),void 0)}var a=-1,r=$.Deferred();return o(),r}},TC.Types.Templates=function(){function t(e,t){var n=document.createElement("script");n.className="__tribe",n.setAttribute("type","text/template"),n.id=t,n.text=e,document.getElementsByTagName("head")[0].appendChild(n)}this.store=function(e,n){var i=TC.Path(n).asMarkupIdentifier().toString();t(e,"template-"+i)},this.loaded=function(e){return $("head script#template-"+TC.Path(e).asMarkupIdentifier()).length>0},this.render=function(e,t){var n=TC.Path(t).asMarkupIdentifier();$(e).empty().append($("head script#template-"+n).html())}},TC.Events.active=function(e){return TC.Utils.elementDestroyed(e.element)},TC.Events.createModel=function(e,t){var n=t.models[e.path],i=n&&n.constructor?new n.constructor(e):{pane:e,data:e.data};TC.Utils.embedState(i,t,e.node),e.model=i},TC.Events.createPubSub=function(e,t){t.pubsub&&(e.pubsub=t.pubsub.createLifetime?t.pubsub.createLifetime():t.pubsub)},TC.Events.dispose=function(e){e.pubsub&&e.pubsub.end&&e.pubsub.end(),e.dispose(),e.is.disposed.resolve()},TC.Events.initialiseModel=function(e){return e.model.initialise?e.model.initialise():null},TC.Events.loadResources=function(e,t){var n=TC.LoadStrategies[t.options.loadStrategy];if(!n)throw"Unknown resource load strategy";return n(e,t)},TC.Events.renderComplete=function(e,t){function n(){e.model.renderComplete&&e.model.renderComplete(),e.is.rendered.resolve(),TC.Utils.raiseDocumentEvent("renderComplete",e),t.renderOperation=new TC.Types.Operation}$.when(TC.transition(e,e.transition,e.reverseTransitionIn)["in"]()).done(n),e.endRender()},TC.Events.renderPane=function(e,t){function i(){ko.applyBindingsToDescendants(e.model,e.element)}var n=t.renderOperation;return e.startRender(),t.templates.render(e.element,e.path),TC.Utils.tryCatch(i,null,t.options.handleExceptions,"An error occurred applying the bindings for "+e.toString()),e.model.paneRendered&&e.model.paneRendered(),n.complete(e),n.promise},TC.LoadHandlers.js=function(e,t,n){function i(i){TC.scriptEnvironment={url:e,resourcePath:t,context:n},TC.Utils.tryCatch($.globalEval,[a(i)],n.options.handleExceptions,"An error occurred executing script loaded from "+e+(t?" for resource "+t:"")),delete TC.scriptEnvironment,TC.logger.debug("Loaded script from "+e)}function a(t){return t+"\n//@ sourceURL=tribe://Application/"+e.replace(/ /g,"_")}return $.ajax({url:e,dataType:"text",async:!n.options.synchronous,cache:!1,success:i})},TC.LoadHandlers.css=function(e,t,n){function a(e){var n=document.getElementById("__tribeStyles");if(n||(n=document.createElement("style"),n.className="__tribe",n.id="__tribeStyles",document.getElementsByTagName("head")[0].appendChild(n)),i)try{n.appendChild(document.createTextNode(e))}catch(a){i=!1}if(!i){if(!n.styleSheet)throw new Error("Unable to append stylesheet for "+t+" to document.");n.styleSheet.cssText+=e}}var i=!0;return $.ajax({url:e,dataType:"text",async:!n.options.synchronous,cache:!1,success:a})},TC.LoadHandlers.htm=function(e,t,n){function i(e){n.templates.store(e,t)}return $.ajax({url:e,dataType:"html",async:!n.options.synchronous,cache:!1,success:i})},TC.LoadHandlers.html=TC.LoadHandlers.htm,TC.LoadStrategies.adhoc=function(e,t){if(void 0!==t.loadedPanes[e.path])return t.loadedPanes[e.path];var n=TC.Path(t.options.basePath).combine(TC.Path(e.path).makeRelative());if(t.templates.loaded(e.path)||t.models[e.path])return null;var i=$.complete([t.loader.get(n.setExtension("js").toString(),e.path,t),t.loader.get(n.setExtension("htm").toString(),e.path,t),t.loader.get(n.setExtension("css").toString(),e.path,t)]);return t.loadedPanes[e.path]=i,$.when(i).fail(function(){TC.logger.error("Unable to load resources for '"+e.path+"'.")}).always(function(){t.loadedPanes[e.path]=null}),i},TC.LoadStrategies.preloaded=function(e,t){return t.models[e.path]||t.templates.loaded(e.path)?null:(TC.logger.error("No resources loaded for '"+e.path+"'."),$.Deferred().reject())},TC.transition=function(e,t,n){function s(){var e=$(r);"fixed"===TC.transition.mode?e.css({position:"fixed",width:e.width(),left:e.offset().left,top:e.offset().top}):e.css({position:"absolute",width:e.width(),left:e.position().left,top:e.position().top})}function l(){if(!e)throw"No target passed to TC.transition";e.constructor===TC.Types.Node?(i=e,a=i.pane,r=a.element):e.constructor===TC.Types.Pane?(a=e,i=a.node,r=a.element):r=e}var i,a,r;l(),t=t||a&&a.transition||i&&i.transition;var o=TC.Transitions[t];return n&&o&&o.reverse&&(o=TC.Transitions[o.reverse]),{"in":function(){return $(r).show(),o&&o["in"](r)},out:function(e){function n(){e===!1?$(r).hide().attr("style",""):$(r).remove()}s();var t=o&&o.out(r);return $.when(t).done(n),t},to:function(e,a){var o=TC.context();return i?TC.Utils.insertPaneAfter(i,r,TC.Utils.getPaneOptions(e,{transition:t,reverseTransitionIn:n}),o):TC.insertNodeAfter(r,TC.Utils.getPaneOptions(e,{transition:t,reverseTransitionIn:n}),null,o),this.out(a),o.renderOperation.promise}}},function(){function n(n,i){function a(e){setTimeout(function(){$(e).addClass("trigger")},30)}function r(e,i,a){return function(){$(e).unbind(t).removeClass(n+" in out prepare trigger"),a&&$(e).hide(),i.resolve()}}TC.Transitions[n]={"in":function(i){if(!e)return null;var o=$.Deferred();return $(i).bind(t,r(i,o)).addClass("prepare in "+n),a(i),o},out:function(i){if(!e)return null;var o=$.Deferred();return $(i).addClass("prepare out "+n).on(t,r(i,o,!0)),a(i),o},reverse:i||n}}function i(){var e=document.body||document.documentElement,t=e.style,n="transition",i=["Moz","Webkit","Khtml","O","ms"];if("string"==typeof t[n])return!0;n=n.charAt(0).toUpperCase()+n.substr(1);for(var a=0,r=i.length;r>a;a++)if("string"==typeof t[i[a]+n])return!0;return!1}var e=i();n("fade"),n("slideLeft","slideRight"),n("slideRight","slideLeft"),n("slideUp","slideDown"),n("slideDown","slideUp");var t="webkitTransitionEnd oTransitionEnd otransitionend transitionend msTransitionEnd"}(),window.__appendStyle=function(e){var t=document.getElementById("__tribeStyles");t||(t=document.createElement("style"),t.className="__tribe",t.id="__tribeStyles",document.getElementsByTagName("head")[0].appendChild(t)),t.styleSheet?t.styleSheet.cssText+=e:t.appendChild(document.createTextNode(e))},window.__appendStyle(".trigger{-webkit-transition:all 250ms ease-in-out;transition:all 250ms ease-in-out}.fade.in.prepare{opacity:0}.fade.in.trigger{opacity:1}.fade.out.prepare{opacity:1}.fade.out.trigger{opacity:0}.slideRight.in.prepare{-webkit-transform:translateX(-100%);transform:translateX(-100%)}.slideRight.in.trigger{-webkit-transform:translateX(0);transform:translateX(0)}.slideRight.out.trigger{-webkit-transform:translateX(100%);transform:translateX(100%)}.slideLeft.in.prepare{-webkit-transform:translateX(100%);transform:translateX(100%)}.slideLeft.in.trigger{-webkit-transform:translateX(0);transform:translateX(0)}.slideLeft.out.trigger{-webkit-transform:translateX(-100%);transform:translateX(-100%)}.slideDown.in.prepare{-webkit-transform:translateY(-100%);transform:translateY(-100%)}.slideDown.in.trigger{-webkit-transform:translateY(0);transform:translateY(0)}.slideDown.out.trigger{-webkit-transform:translateY(100%);transform:translateY(100%)}.slideUp.in.prepare{-webkit-transform:translateY(100%);transform:translateY(100%)}.slideUp.in.trigger{-webkit-transform:translateY(0);transform:translateY(0)}.slideUp.out.trigger{-webkit-transform:translateY(-100%);transform:translateY(-100%)}"),function(){TC.registerModel=function(){var e=TC.scriptEnvironment||{},t=e.context||TC.context(),n=TC.Utils.arguments(arguments),i=n.func,a=n.object,r=n.string||e.resourcePath;t.models.register(r,i,a)},TC.run=function(e){TC.options=$.extend(TC.options,e),TC.options.pubsub=TC.options.pubsub||new Tribe.PubSub({sync:TC.options.synchronous,handleExceptions:TC.options.handleExceptions}),ko.applyBindings()}}(),function(){var e;TC.context=function(t){e=e||{models:new TC.Types.Models,loader:new TC.Types.Loader,options:TC.options,templates:new TC.Types.Templates,loadedPanes:{}};var n={renderOperation:new TC.Types.Operation,pubsub:TC.options.pubsub};return $.extend({},e,n,t)}}(),TC.options.defaultUrlProvider={urlDataFrom:function(e){return e&&{url:"#"+$.param(e)}},paneOptionsFrom:function(e){return e&&TC.Utils.deparam(e.substr(1))}},function(){var e=TC.Utils;TC.createNode=function(t,n,i,a){i=i||TC.nodeFor(t),a=a||e.contextFor(t)||TC.context();var r=new TC.Types.Node(i);return e.bindPane(r,t,n,a),r},TC.appendNode=function(e,t,n,i){var a=$("<div/>").appendTo(e);return TC.createNode(a,t,n,i)},TC.insertNodeAfter=function(e,t,n,i){var a=$("<div/>").insertAfter(e);return TC.createNode(a,t,n||TC.nodeFor(e),i)},TC.nodeFor=function(e){return e&&TC.Utils.extractNode(ko.contextFor($(e)[0]))}}(),function(){function e(e){return function(){return e}}function t(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push($.extend({$key:n},e[n]));return t}ko.bindingHandlers.foreachProperty={init:function(n,i,a,r,o){return ko.bindingHandlers.foreach.init(n,e(t(i())),a,r,o)},update:function(n,i,a,r,o){return ko.bindingHandlers.foreach.update(n,e(t(i())),a,r,o)}}}(),ko.bindingHandlers.navigate={init:function(e,t,n,i){function l(){return function(){r.navigate(o.value,TC.Utils.cloneData(o.data))}}var r=TC.nodeFor(e);if(r){var o=TC.Utils.normaliseBindings(t,n),s=ko.bindingHandlers.validatedClick||ko.bindingHandlers.click;s.init(e,l,n,i)}}},ko.bindingHandlers.navigateBack={init:function(e,t,n,i){function o(){return function(){r.navigateBack()}}var r=TC.nodeFor(e);r&&ko.bindingHandlers.click.init(e,o,n,i)}},function(){function e(e,t,n,i,a){function r(){return TC.Utils.getPaneOptions(ko.utils.unwrapObservable(t()),n())}return TC.createNode(e,r(),TC.Utils.extractNode(a),TC.Utils.extractContext(a)),{controlsDescendantBindings:!0}}ko.bindingHandlers.pane={init:e}}(),ko.bindingHandlers.publish={init:function(e,t,n,i){function l(){return function(){r.publish(o.value,TC.Utils.cloneData(o.data))}}var r=TC.nodeFor(e).pane.pubsub;if(r){var o=TC.Utils.normaliseBindings(t,n),s=ko.bindingHandlers.validatedClick||ko.bindingHandlers.click;s.init(e,l,n,i)}}};