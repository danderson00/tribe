suite('tribe.utilities.streams', function () {
    var streams, write, end;

    setup(function () {
        require.stub('through', function (fwrite, fend) {
            write = fwrite;
            end = fend;
        });
        require.refresh('tribe/utilities/streams');
        streams = require('tribe/utilities/streams');
    });

    test('throughTransform only executes transform if file exists in provided list', function () {
        var spy = sinon.spy(),
            transform = streams.throughTransform(spy, [{ path: 'test' }]);

        transform('test');
        end.call({ queue: function () { } });
        expect(spy.callCount).to.equal(1);

        transform('test2');
        end.call({ queue: function () { } });
        expect(spy.callCount).to.equal(1);
    });

    test('throughTransform executes transform if file list is not provided', function () {
        var spy = sinon.spy(),
            transform = streams.throughTransform(spy);

        transform('test');
        end.call({ queue: function () { } });
        expect(spy.callCount).to.equal(1);
    });
});