suite('tribe.eventStore.sqlite3.queries', function () {
    var queries = require('tribe/eventStore/sqlite3/queries');

    test("store simple envelope with no indexes", function () {
        var envelope = { id: 1, topic: 'test' },
            query = queries.store([], envelope);
        expect(query.query).to.equal("insert into messages (id,topic,envelope) values (?,?,?)");
        expect(query.params).to.deep.equal([1, 'test', JSON.stringify(envelope)]);
    });

    test("store envelope with indexes", function () {
        var envelope = { id: 1, topic: 'test', data: { value1: 1, value2: 2 } },
            query = queries.store(['value1', 'value2'], envelope);
        expect(query.query).to.equal("insert into messages (id,topic,envelope,value1,value2) values (?,?,?,?,?)");
        expect(query.params).to.deep.equal([1, 'test', JSON.stringify(envelope), 1, 2]);
    });

    test("retrieve with index", function () {
        var query = queries.retrieve({ indexName: 'testId', indexValue: 1 });
        expect(query.query).to.equal('select * from messages where testId = ?');
        expect(query.params).to.deep.equal([1]);
    });

    test("retrieve with index and startId", function () {
        var query = queries.retrieve({ indexName: 'testId', indexValue: 1, startId: 10 });
        expect(query.query).to.equal('select * from messages where testId = ? and id >= ?');
        expect(query.params).to.deep.equal([1, 10]);
    });
});