suite('tribe.client.scopes', function () {
    var eventStore, scopes, gateway;

    setup(function () {
        require.refreshAll();
        eventStore = require('tribe/client/eventStore');
        eventStore.type = 'memory';
        gateway = require.stub('./gateway', {
            publish: sinon.spy(),
            scope: {
                request: sinon.spy()
            }
        });
        scopes = require('tribe/client/scopes');
    });

    teardown(function () {
        eventStore.close();
    });

    test("request returns messages stored locally", function () {
        return eventStore.store({ id: 1 }, { data: { id: 1 }})
            .then(function () {
                return scopes.request({ id: 1 });
            })
            .then(function (data) {
                expect(data.envelopes.length).to.equal(1);
            });
    });

    // test("request retrieves messages from server on first request", function () {
    //
    // });
    //
    // test("request does not retrieve messages from server on second request", function () {
    //
    // });
    //
    // test("request publishes subsequent messages to server", function () {
    //
    // });
    //
    // test("messages are not published to server after release", function () {
    //
    // });
    //
    // test("messages are only published to server once after multiple requests", function () {
    //
    // });
});
