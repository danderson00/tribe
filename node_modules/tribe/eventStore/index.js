var log = require('tribe.logger'),
    stores = {
        sqlite3: require('./sqlite3'),
        //indexeddb: require('./indexeddb')
    },
    store;

module.exports = {
    initialise: function (options, indexes) {
        store = stores[options.name];
        return store.initialise(options, indexes).then(function () {
            log.info('Event store initialised (' + options.name + ')');
        });
    },
    store: function (envelope) {
        if (!store) throw new Error('initialise must be called first');
        return store.add(envelope);
    },
    retrieve: function (options) {
        if (!store) throw new Error('initialise must be called first');
        return store.query(options);
    }
};