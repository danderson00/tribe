var _ = require('underscore');

module.exports = {
    evalInContext: function (source, context) {
        source = '(function(' + _.keys(context).join(', ') + ') {' + source + '})';

        var compiled = eval(source);

        return compiled.apply(context, _.values(context));
    },
    toString: function (source) {
        return '"' + source.replace(/\n/g, '\\n').replace(/\"/g, '\\"') + '"';
    }
}