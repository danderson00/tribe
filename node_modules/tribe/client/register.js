var facets = require('tribe/facets'),
    flow = require('tribe/facets/flow')

require('tribe.composite')

module.exports = {
    facet: function (constructor, path) {
        facets.register(resourcePath(path), constructor)
    },
    flow: function(constructor, path) {
        facets.register('/__flows' + resourcePath(path), flow(constructor))
    },
    model: function (constructor, path) {
        T.registerModel(constructor, resourcePath(path))
    }
}

function resourcePath(path) {
    if(path)
        return path
    if(typeof T !== 'undefined' && T.scriptEnvironment && T.scriptEnvironment.resourcePath)
        return T.scriptEnvironment.resourcePath
    if(window.scriptEnvironment && window.scriptEnvironment.resourcePath)
        return window.scriptEnvironment.resourcePath
    throw new Error('Unable to determine resource path')
}