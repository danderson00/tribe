ko.virtualElements.allowedBindings.actor = true;
ï»¿ko.bindingHandlers.actor = {
    init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var node = T.Utils.extractNode(bindingContext),
            context = T.Utils.extractContext(bindingContext),
            actorPath = valueAccessor(),
            pubsub = node.pane.pubsub,
            token = {};

        if(actorPath) {
            context.renderOperation.add(token);

            pubsub.obtainActor(actorPath, allBindingsAccessor().scope).then(function (actor) {
                ko.applyBindingsToDescendants(bindingContext.extend(actor), element);

                T.nodeFor(element).pane.is.disposed.then(function () {
                    actor.__actor.release();
                });

                context.renderOperation.complete(token);
            }).fail(function (err) {
                T.logger.error('Failed to retrieve actor', err);
            });
        }

        return { controlsDescendantBindings: true };
    }
};
