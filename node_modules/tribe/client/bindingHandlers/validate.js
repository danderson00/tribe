['click', 'publish'].forEach(wrapBindingHandler)

function wrapBindingHandler(name) {
    var originalBindingHandler = ko.bindingHandlers[name]
    ko.bindingHandlers[name] = {
        init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
            var self = this,
                originalHandler = valueAccessor(),
                allBindings = allBindingsAccessor(),
                newValueAccessor = function () {
                    return function () {
                        if(!allBindings.validate || (!bindingContext.$root.isValid || bindingContext.$root.isValid()))
                            return originalHandler.apply(viewModel, arguments)
                    }
                }
            return originalBindingHandler['init'].call(self, element, newValueAccessor, allBindingsAccessor, viewModel, bindingContext)
        }
    }
}