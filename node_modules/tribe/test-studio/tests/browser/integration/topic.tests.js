var hub = require('tribe/client/hub'),
    uuid = require('node-uuid'),
    Q = require('q');

suite('tribe.browser.integration.topic', function () {
    test("topic renders one element per message", function () {
        var actorId = uuid.v4();
        hub.publish({ topic: 'topic', data: { actorId: actorId, value: 'a' } });
        hub.publish({ topic: 'topic', data: { actorId: actorId, value: 'b' } });
        hub.publish({ topic: 'topic', data: { actorId: 'other scope', value: 'c' } });

        var node = T.createNode('body', { path: '/tests/topic', scope: { actorId: actorId } });
        return Q.when(node.pane.is.rendered).then(function () {
            expect($('#parent').children().text()).to.equal('ab');
        })
    })
})
