suite('tribe.browser.integration.bindingHandlers.arrayField', function () {
    test("length binding sets initial number of elements from scalar", function () {
        var node = T.createNode('body', { path: '/tests/arrayField', data: { length: 2 } })
        expect($('input').length).to.equal(2)
    })

    test("length binding sets number of elements from observable", function () {
        var length = ko.observable(2),
            node = T.createNode('body', { path: '/tests/arrayField', data: { length: length } })
        expect($('input').length).to.equal(2)
        length(3)
        expect($('input').length).to.equal(3)
    })

    test("creates array of observables accessed from value property", function () {
        var length = ko.observable(3),
            node = T.createNode('body', { path: '/tests/arrayField', data: { length: length } }),
            array = node.pane.model.fields.field

        array()[1]('test')
        expect($('input:eq(1)').val()).to.equal('test')
        $('input:eq(1)').val('test2')
        $('input:eq(1)').change()
        expect(array()[1]()).to.equal('test2')
    })

    test("shortening length preserves array values", function () {
        var length = ko.observable(3),
            node = T.createNode('body', { path: '/tests/arrayField', data: { length: length } }),
            array = node.pane.model.fields.field

        array()[1]('test')
        length(2)
        expect($('input').length).to.equal(2)
        expect(array()[1]()).to.equal('test')
        expect($('input:eq(1)').val()).to.equal('test')
    })
})
