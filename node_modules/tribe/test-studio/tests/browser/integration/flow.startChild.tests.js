suite('tribe.browser.integration.flow.startChild', function () {
    test("publishing messages triggers starting children", function () {
        var pubsub = require('tribe.pubsub'),
            node = T.appendNode('body', { path: '/tests/childFlow', pubsub: pubsub })

        return T.Utils.contextFor($('body div div')).renderOperation.promise.then(function () {
            // navigation will occur synchronously in this case (no transition)
            expect($('span').text()).to.equal('two')
            pubsub.publish('topic')
            return T.Utils.contextFor($('body div div')).renderOperation.promise.then(function () {
                expect($('span').text()).to.equal('four')
            })
        })
    })
})
