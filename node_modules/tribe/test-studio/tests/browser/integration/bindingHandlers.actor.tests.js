suite('tribe.browser.integration.bindingHandlers.actor', function () {
    test("actors are released when pane is removed from DOM", function () {
        var spy = sinon.spy()
        var pubsub = require('tribe.pubsub'),
            node = T.appendNode('body', { path: '/tests/actor', pubsub: pubsub, data: constructor })

        // this fires before the renderComplete event completes, in fact the renderComplete event is not completing at all in this case - the dispose event never has a chance to fire
        return node.pane.is.rendered.then(function () {
            pubsub.publishSync('test')
            node.pane.remove()
            pubsub.publishSync('test')
            expect(spy.callCount).to.equal(1)
        })

        function constructor(actor) {
            actor.handles('test', spy)
        }
    })
})
