require('tribe').register.facet(function (facet) {
    var operations = require('../modules/operations'),
        queries, suite;

    facet.isDistributed();

    facet.onstart = function (data) {
        suite = data;
        queries = require('../modules/queries').for(suite);
    };

    facet.handles({
        'test.complete': function (test) {
            operations.updateTest(queries.findTest(test), test);
        },
        'test.loaded': function (test) {
            operations.updateTest(queries.findTest(test), test);
        },
        'test.removed': function (test) {
            operations.removeTest(queries.findTest(test), suite);
        },
        'test.run': function (tests) {
            operations.setPending(suite, tests);
        }
    });
});
