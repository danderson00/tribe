var repository = require('./repository'),
    extensions = require('./extensions'),
    _ = require('underscore');

var api = module.exports = {
    actors: repository.actors,
    register: repository.register,
    indexes: function () {
        return _.unique(_.reduce(repository.actors, function (indexes, actor) {
            // we only have the property message filter at the moment
            if (actor.definition.messageFilter)
                indexes.push(actor.definition.messageFilter.options.property);
            return indexes;
        }, []));
    },
    replay: function (actor, envelopes) {
        _.each(envelopes, function (envelope) {
            if (actor.handles[envelope.topic])
                actor.handles[envelope.topic](envelope.data, envelope);
        });
    }
};
