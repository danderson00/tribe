var _ = require('underscore');

// this is less than ideal. It allows code running on the server side like actors to use knockout without requiring it or even installing it
// possibly will be replaced by passing knockout to modules using a custom module loader like tests are now
ko = require('knockout');

module.exports = {
    // server
    start: function (options) {
        options = require('tribe/options').apply(options);

        _.each(options.builds, function (build) {
            require('tribe/build')
                .configure(build)
                .watch()
                .execute();
        });

        if (options.debug)
            require('tribe/process/inspector').start(options.inspectorPort);

        require('tribe/server')
            .configure(options.server)
            .start();

        require('tribe/test').initialise(true);
    },

    // common
    register: require('tribe/register'),
    pubsub: require('tribe.pubsub'),
    options: require('tribe/options')
};