var d3 = require('d3')

module.exports = function (options) {
    return {
        handler: function (value, pathValues, allPaths) {
            // this is a hacky way to show an "incremental" line graph, i.e. all lines update on each message
            if (pathValues.length === 0)
                // unless it's the first message, then just push it on the appropriate array
                pathValues.push([0, value])
            else
                allPaths.forEach(function(x) {
                    if(x === pathValues)
                        x.push([x.length, value])
                    else
                        x.push([x.length, x[x.length - 1][1] || 0])
                })
        },
        createScaling: function () {
            return {
                x: d3.scaleLinear().range([0, options.width]),
                y: d3.scaleLinear().range([options.height, 0])
            }
        },
        createAxes: function () {
            return {
                x: d3.axisBottom().tickFormat(d3.format(",.0f")).tickSize(-options.height),
                y: d3.axisLeft().tickFormat(d3.format(",.0f")).tickSize(-options.width)
            }
        }
    }
}