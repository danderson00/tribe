var Rx = require('rx')
require('../../Observable/extensions')

suite('tribe.rx.Observable.extensions.range', function () {
    test("is always zero for single group", function () {
        var source = new Rx.Subject(),
            range = source.groupBy(x => x).select(x => x.count()).range().asScalar()

        source.onNext(1)
        source.onNext(1)
        source.onNext(1)
        expect(range()).to.equal(0)
    })

    test("reflects difference between two groups", function () {
        var source = new Rx.Subject(),
            range = source.groupBy(x => x).select(x => x.count()).range().asScalar()

        source.onNext(1)
        source.onNext(2)
        source.onNext(1)
        expect(range()).to.equal(1)

        source.onNext(1)
        source.onNext(2)
        source.onNext(1)
        expect(range()).to.equal(2)
    })

    test("reflects difference between max and min of three groups", function () {
        var source = new Rx.Subject(),
            range = source.groupBy(x => x).select(x => x.count()).range().asScalar()

        source.onNext(1)
        source.onNext(2)
        source.onNext(3)
        source.onNext(3)
        expect(range()).to.equal(1)

        source.onNext(3)
        source.onNext(3)
        source.onNext(1)
        expect(range()).to.equal(3)
    })
})
