var Rx = require('rx')
require('../../Observable/overrides')

suite('tribe.rx.Observable.overrides.groupBy', function () {
    test("maintains existing behavior", function () {
        var source = new Rx.Subject(),
            observable = source.groupBy(x => x.p1),
            spy = sinon.spy()
        observable.subscribe(spy)
        source.onNext({ p1: 1 })
        source.onNext({ p1: 1 })
        source.onNext({ p1: 2 })
        expect(spy.firstCall.args[0].key).to.equal(1)
        expect(spy.secondCall.args[0].key).to.equal(2)
    })

    test("groups by array values", function () {
        var source = new Rx.Subject(),
            observable = source.groupBy(x => x.p1),
            spy = sinon.spy()
        observable.subscribe(spy)
        source.onNext({ p1: [1] })
        source.onNext({ p1: [1] })
        source.onNext({ p1: [2] })
        expect(spy.firstCall.args[0].key).to.deep.equal([1])
        expect(spy.secondCall.args[0].key).to.deep.equal([2])
    })
})
