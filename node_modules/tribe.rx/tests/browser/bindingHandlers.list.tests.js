var Rx = require('rx')

suite('tribe.rx.browser.bindingHandlers.scalar', function () {
    test("foreach converts Rx.Observable to ObservableArray", function () {
        var observable = new Rx.Subject()

        // we don't want this with Rx.Observables, otherwise a blank, new Observable is created each time the value changes
        $('body').append('<ul data-bind="foreach: value"><li data-bind="text: $data"></li></ul>')
        ko.applyBindings({ value: observable })

        observable.onNext('one')
        expect($('body ul').children().length).to.equal(1)

        observable.onNext('two')
        expect($('body ul').children().length).to.equal(2)
        expect($('body ul').text()).to.equal('onetwo')
    })
})
