var wrapper = require('./transaction'),
    cursor = require('./cursor');

module.exports = function (db) {
    return {
        add: function (entity) {
            var transaction = db.transaction(['test'], 'readwrite'),
                store = transaction.objectStore('test'),
                promise = wrapper(transaction);

            store.add(entity);

            return promise;
        },
        single: function (key) {
            var transaction = db.transaction(['test'], 'readwrite'),
                store = transaction.objectStore('test'),
                promise = wrapper(transaction);

            request = store.get(key);

            return promise.then(function () {
                return request.result;
            });
        },
        all: function () {
            return cursor(db);
        }
    };
};

