!function t(n,r,e){function i(u,o){if(!r[u]){if(!n[u]){var c="function"==typeof require&&require;if(!o&&c)return c(u,!0);if(s)return s(u,!0);var a=new Error("Cannot find module '"+u+"'");throw a.code="MODULE_NOT_FOUND",a}var f=r[u]={exports:{}};n[u][0].call(f.exports,function(t){var r=n[u][1][t];return i(r?r:t)},f,f.exports,t,n,r,e)}return r[u].exports}for(var s="function"==typeof require&&require,u=0;u<e.length;u++)i(e[u]);return i}({1:[function(t,n){n.exports=function(t,n){function r(t){return function(n,r){s.endsChildrenExplicitly||s.endChildren(n),s.beforeMessage&&s.beforeMessage(r),t(n,r,s),s.afterMessage&&s.afterMessage(r)}}function e(t){return function(n){s.startChild({handles:t},n)}}function i(){return function(t){s.end(t)}}var s=this;t?t.constructor===Function?this.pubsub.subscribe(n,r(t),this.metadata.expression):this.pubsub.subscribe(n,e(t),this.metadata.expression):this.pubsub.subscribe(n,i())}},{}],2:[function(t,n){var r=t("./actor.addHandler"),e=t("./utils"),i=n.exports=function(t,n,r,i){function s(){n&&(n.constructor===Function?o.instance=new n(o):e.copyProperties(n,o,["handles","endsChildrenExplicitly","onstart","onresume","onsuspend","onend"]))}function u(){e.each(i,function(t,n){o[n]=t})}var o=this;t=t.createLifetime({origin:"actor"}),this.pubsub=t,this.children=[],this.id=r,this.metadata={},u(),s(),this.handles=this.handles||{},this.topics=e.keys(this.handles)};i.prototype.start=function(t){return this.onstart&&this.onstart(t,this),e.each(this.handles,this.addHandler,this),this},i.prototype.startChild=function(t,n){return this.children.push(new i(this.pubsub,t).start(n)),this},i.prototype.resume=function(t,n){return this.data=t,this.onresume&&this.onresume(n,this),e.each(this.handles,this.addHandler,this),this},i.prototype.suspend=function(t){return this.onsuspend&&this.onsuspend(t,this),this.pubsub.end(),this.suspendChildren(t),this},i.prototype.end=function(t){return this.onend&&this.onend(t,this),this.pubsub.end(),this.endChildren(t),this},i.prototype.endChildren=function(t){e.each(this.children,function(n){n.end(t)})},i.prototype.suspendChildren=function(t){e.each(this.children,function(n){n.suspend(t)})},i.prototype.isScopedTo=function(t){this.metadata.expression={p:"data."+t,v:this.id}},i.prototype.replay=function(t){var n=this;n.pubsub.suspend(),e.each(t,function(t){n.handles[t.topic]&&n.handles[t.topic](t.data,t)}),n.pubsub.resume()},i.prototype.addHandler=r},{"./actor.addHandler":1,"./utils":13}],3:[function(t){"undefined"==typeof Tribe&&(Tribe={}),Tribe.PubSub=t("./pubsub"),Tribe.PubSub.Actor=t("./actor")},{"./actor":2,"./pubsub":9}],4:[function(t,n){n.exports=function(n,r){function e(t,n){var e=t&&t.topic?t:{topic:t,data:n};return e.channelId=r,e}function i(t){return function(n,e){e.channelId===r&&t(n,e)}}var s=this,u=t("./lifetime");n=n.createLifetime(),this.id=r,this.owner=n.owner,this.publish=function(t,r){return n.publish(e(t,r))},this.publishSync=function(t,r){return n.publishSync(e(t,r))},this.subscribe=function(t,r){return n.subscribe(t,i(r))},this.subscribeOnce=function(t,r){return n.subscribeOnce(t,i(r))},this.unsubscribe=function(t){return n.unsubscribe(t)},this.end=function(){return n.end()},this.createLifetime=function(){return new u(s,s.owner)}}},{"./lifetime":7}],5:[function(t,n){var r=t("../utils");n.exports=function(){var t={};return{add:function(n,r){t[r]=n},remove:function(n){delete t[n]},get:function(){return r.values(t)}}}},{"../utils":13}],6:[function(t,n){var r=t("../utils"),e=t("tribe.expressions");n.exports=function(){var t={},n={};return{add:function(r,e,i){t[i.p]||(t[i.p]={});var s=t[i.p];s[i.v]||(s[i.v]={}),s[i.v][e]=r,n[e]=i},remove:function(r){var e=n[r];e&&(delete t[e.p][e.v][r],delete n[r])},get:function(n){if(!n.data)return[];var i=[];for(var s in t)if(t.hasOwnProperty(s)){var u=e.evaluateKeyPath(s,n);i=i.concat(r.values(t[s][u]))}return i}}}},{"../utils":13,"tribe.expressions":15}],7:[function(t,n){var r=t("./channel"),e=t("./actor"),i=t("./utils"),s=n.exports=function(t,n,r){function e(t){return i.isArray(t)?c=c.concat(t):c.push(t),t}function u(t,n){var e=t&&t.topic?t:{topic:t,data:n};for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i]);return e}var o=this,c=[],a=!0;this.owner=n,this.publish=function(n,r){return a?t.publish(u(n,r)):void 0},this.publishSync=function(n,r){return a?t.publishSync(u(n,r)):void 0},this.subscribe=function(n,r,i){var s=t.subscribe(n,r,i);return e(s)},this.subscribeOnce=function(n,r){var i=t.subscribeOnce(n,r);return e(i)},this.unsubscribe=function(n){return t.unsubscribe(n)},this.end=function(){return t.unsubscribe(c)},this.createLifetime=function(t){return new s(o,o.owner,t)},this.suspend=function(){a=!1},this.resume=function(){a=!0}};s.prototype.startActor=function(t,n){return new e(this,t).start(n)},s.prototype.channel=function(t){return new r(this,t)}},{"./actor":2,"./channel":4,"./utils":13}],8:[function(t,n){var r=t("./utils");n.exports={sync:!1,handleExceptions:!0,exceptionHandler:function(t,n){"undefined"!=typeof console&&console.log("Exception occurred in subscriber to '"+n.topic+"': "+r.errorDetails(t))}}},{"./utils":13}],9:[function(t,n){var r=t("./lifetime"),e=t("./channel"),i=t("./actor"),s=t("./topicList"),u=t("./subscribeOnce"),o=t("./subscribeTo"),c=t("./options"),a=t("./utils"),f=n.exports=function(t){function n(t){function n(n){var r=i("exceptionHandler");if(i("handleExceptions")&&r)try{n(t.data,t)}catch(e){r(e,t)}else n(t.data,t)}for(var r=h.get(t),e=t.sync===!0||f.sync===!0,s=0,u=r.length;u>s;s++)e?n(r[s]):!function(t){setTimeout(function(){n(t)})}(r[s])}function e(t,n){return t&&t.topic?t:{topic:t,data:n}}function i(t){return f.options.hasOwnProperty(t)?f.options[t]:c[t]}var f=this;this.owner=this,this.options=t||{},this.sync=i("sync");var h=new s;this.subscribers=h,this.publish=function(t,r){return n(e(t,r))},this.publishSync=function(t,r){var i=e(t,r);return i.sync=!0,n(i)},this.subscribe=function(t,n,r){return"string"==typeof t?h.add(t,n,r):a.isArray(t)?a.map(t,function(t){return h.add(t,n,r)}):a.map(t,function(t,n){return h.add(n,t,r)})},this.subscribe.to=o(this),this.unsubscribe=function(t){if(a.isArray(t)){for(var n=[],r=0,e=t.length;e>r;r++)n.push(h.remove(t[r]));return n}return h.remove(t)},this.createLifetime=function(t){return new r(f,f,t)},this.subscribeOnce=u};f.prototype.channel=function(t){return new e(this,t)},f.prototype.startActor=function(t,n){return new i(this,t).start(n)}},{"./actor":2,"./channel":4,"./lifetime":7,"./options":8,"./subscribeOnce":10,"./subscribeTo":11,"./topicList":12,"./utils":13}],10:[function(t,n){n.exports=function(n,r){function e(){var t={};return o.each(n,function(n){t[n]=s(r)}),t}function i(){return o.map(n,function(t,n){return c.subscribe(n,s(t))})}function s(t){return function(){c.end(),t.apply(u,arguments)}}var u=this,o=t("./utils"),c=this.createLifetime();return"string"==typeof n?c.subscribe(n,s(r)):c.subscribe(o.isArray(n)?e():i())}},{"./utils":13}],11:[function(t,n){n.exports=function(t){return function(n){return{when:function(r){return{equals:function(e){return{execute:function(i){return t.subscribe(n,i,{p:r,v:e})}}}}},execute:function(r){return t.subscribe(n,r)}}}}},{}],12:[function(t,n){var r={"default":t("./filters/default"),property:t("./filters/property")};n.exports=function(){function t(t,n){if("*"===n)return!0;var r="^"+n.replace(/\./g,"\\.").replace(/\*/g,"[^.]*")+"$";return t.match(r)}var n={},e=-1;this.get=function(r){var e=r.topic,i=[];for(var s in n)if(n.hasOwnProperty(s)&&t(e,s))for(var u in n[s])n[s].hasOwnProperty(u)&&(i=i.concat(n[s][u].get(r)));return i},this.add=function(t,i,s){var u=(++e).toString(),o=s?"property":"default";n.hasOwnProperty(t)||(n[t]={});var c=n[t];return c[o]||(c[o]=r[o](t)),c[o].add(i,u,s),u},this.remove=function(t){for(var r in n)if(n.hasOwnProperty(r))for(var e in n[r])n[r].hasOwnProperty(e)&&n[r][e].remove(t)}}},{"./filters/default":5,"./filters/property":6}],13:[function(t,n){var r=n.exports={};r.isArray=function(t){return t.constructor===Array},r.copyProperties=function(t,n,r){for(var e=0,i=r.length;i>e;e++){var s=r[e];t.hasOwnProperty(s)&&(n[s]=t[s])}},r.errorDetails=function(t){return t?t.constructor===String?t:(t.stack||"")+(t.inner?"\n\n"+r.errorDetails(t.inner):"\n"):""};var e=Array.prototype.forEach,i=Array.prototype.map,s={};r.each=function(t,n,r){if(null!=t)if(e&&t.forEach===e)t.forEach(n,r);else if(t.length===+t.length){for(var i=0,u=t.length;u>i;i++)if(n.call(r,t[i],i,t)===s)return}else for(var o in t)if(t.hasOwnProperty(o)&&n.call(r,t[o],o,t)===s)return},r.map=function(t,n,e){var s=[];return null==t?s:i&&t.map===i?t.map(n,e):(r.each(t,function(t,r,i){s[s.length]=n.call(e,t,r,i)}),s)},r.keys=function(t){var n=[];for(var r in t)t.hasOwnProperty(r)&&n.push(r);return n},r.values=function(t){var n=[];for(var r in t)t.hasOwnProperty(r)&&n.push(t[r]);return n}},{}],14:[function(t,n){t("./indexOf");var r=t("./keyPath");n.exports=function(t,n){var e=r(t.p,n);switch(t.o){case void 0:case"=":return e===t.v;case"!=":return e!==t.v;case"<":return e<t.v;case"<=":return e<=t.v;case">":return e>t.v;case">=":return e>=t.v;case"in":return t.v.indexOf(e)>-1;case"contains":return e.indexOf(t.v)>-1}}},{"./indexOf":16,"./keyPath":17}],15:[function(t,n){var r=t("./keyPath"),e=t("./evaluate");n.exports={evaluateKeyPath:r,evaluate:e}},{"./evaluate":14,"./keyPath":17}],16:[function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(t){"use strict";if(null==this)throw new TypeError;var n,r,e=Object(this),i=e.length>>>0;if(0===i)return-1;if(n=0,arguments.length>1&&(n=Number(arguments[1]),n!=n?n=0:0!=n&&1/0!=n&&n!=-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=i)return-1;for(r=n>=0?n:Math.max(i-Math.abs(n),0);i>r;r++)if(r in e&&e[r]===t)return r;return-1})},{}],17:[function(t,n){n.exports=function(t,r){if(r){var e=t.indexOf(".");return-1===e?r[t]:n.exports(t.substring(e+1),r[t.substring(0,e)])}}},{}]},{},[3]);
