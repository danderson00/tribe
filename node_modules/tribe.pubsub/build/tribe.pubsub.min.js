!function t(n,r,e){function i(o,u){if(!r[o]){if(!n[o]){var c="function"==typeof require&&require;if(!u&&c)return c(o,!0);if(s)return s(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var f=r[o]={exports:{}};n[o][0].call(f.exports,function(t){var r=n[o][1][t];return i(r?r:t)},f,f.exports,t,n,r,e)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;o<e.length;o++)i(e[o]);return i}({1:[function(t,n,r){function e(t,n){var r=n;return n&&n.constructor===Object&&(r=n[t.p]),{p:t.p,o:t.o,v:r}}t("./keyPath");n.exports=function(t,n){if(void 0!==t&&null!==t&&(t.constructor!==Array||0!==t.length)){if(t.constructor===Array){for(var r=[],i=0,s=t.length;s>i;i++)r.push(e(t[i],n));return r}return e(t,n)}}},{"./keyPath":7}],2:[function(t,n,r){var e=t("tribe.functional/flatten");n.exports=function(t){return e(Array.prototype.slice.call(arguments))}},{"tribe.functional/flatten":8}],3:[function(t,n,r){n.exports=function(t,n){var r=[];for(var e in t)t.hasOwnProperty(e)&&r.push({p:(n?n+".":"")+e,v:t[e]});return r}},{}],4:[function(t,n,r){function e(t,n){var r=i(t.p,n);switch(t.o){case void 0:case"=":return r===t.v;case"!=":return r!==t.v;case"<":return r<t.v;case"<=":return r<=t.v;case">":return r>t.v;case">=":return r>=t.v;case"in":return t.v.indexOf(r)>-1;case"contains":return r.indexOf(t.v)>-1}}t("./indexOf");var i=t("./keyPath");n.exports=function(t,n){if(t.constructor===Array){for(var r=0,i=t.length;i>r;r++)if(!e(t[r],n))return!1;return!0}return e(t,n)}},{"./indexOf":6,"./keyPath":7}],5:[function(t,n,r){var e=t("./keyPath"),i=t("./evaluate"),s=t("./apply"),o=t("./create"),u=t("./combine");n.exports={evaluateKeyPath:e,setKeyPath:e.set,evaluate:i,apply:s,create:o,combine:u}},{"./apply":1,"./combine":2,"./create":3,"./evaluate":4,"./keyPath":7}],6:[function(t,n,r){Array.prototype.indexOf||(Array.prototype.indexOf=function(t){"use strict";if(null==this)throw new TypeError;var n,r,e=Object(this),i=e.length>>>0;if(0===i)return-1;if(n=0,arguments.length>1&&(n=Number(arguments[1]),n!=n?n=0:0!=n&&n!=1/0&&n!=-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=i)return-1;for(r=n>=0?n:Math.max(i-Math.abs(n),0);i>r;r++)if(r in e&&e[r]===t)return r;return-1})},{}],7:[function(t,n,r){n.exports=function(t,r){if(r){var e=t.indexOf(".");return-1===e?r[t]:n.exports(t.substring(e+1),r[t.substring(0,e)])}},n.exports.set=function(t,r,e){if(r){var i=t.indexOf(".");if(-1===i)r[t]=e;else{var s=t.substring(0,i),o=t.substring(i+1),u=r[s];u&&"object"==typeof u||(u={},r[s]=u),n.exports.set(o,u,e)}}}},{}],8:[function(t,n,r){n.exports=function(t){return t.reduce(function(t,r){return void 0===r||null===r?t:t.concat(r.constructor===Array?n.exports(r):r)},[])}},{}],9:[function(t,n,r){n.exports=function(t,n){function r(t){return function(n,r){s.endsChildrenExplicitly||s.endChildren(n),s.beforeMessage&&s.beforeMessage(r),t(n,r,s),s.afterMessage&&s.afterMessage(r)}}function e(t){return function(n,r){s.startChild({handles:t},n)}}function i(){return function(t){s.end(t)}}var s=this;t?t.constructor===Function?this.pubsub.subscribe(n,r(t),this.metadata.expression):this.pubsub.subscribe(n,e(t),this.metadata.expression):this.pubsub.subscribe(n,i())}},{}],10:[function(t,n,r){var e=t("./actor.addHandler"),i=(t("tribe.expressions"),t("./utils")),s=n.exports=function(t,n,r,e){function s(){n&&n.constructor===Function?(o.instance=new n(o),o.instance.__actor=o):i.copyProperties(n,o,["handles","endsChildrenExplicitly","onstart","onresume","onsuspend","onend"])}var o=this;t=t.createLifetime(r),this.pubsub=t,this.children=[],this.scope=r,this.metadata={expression:[],scope:[]},this.dependencies=e,s(),this.handles=this.handles||{},this.topics=i.keys(this.handles)};s.prototype.start=function(t){return this.onstart&&this.onstart(t,this),i.each(this.handles,this.addHandler,this),this},s.prototype.startChild=function(t,n){return this.children.push(new s(this.pubsub,t).start(n)),this},s.prototype.resume=function(t,n){return this.data=t,this.onresume&&this.onresume(n,this),i.each(this.handles,this.addHandler,this),this},s.prototype.suspend=function(t){return this.onsuspend&&this.onsuspend(t,this),this.pubsub.end(),this.suspendChildren(t),this},s.prototype.end=function(t){return this.onend&&this.onend(t,this),this.pubsub.end(),this.endChildren(t),this},s.prototype.endChildren=function(t){i.each(this.children,function(n){n.end(t)})},s.prototype.suspendChildren=function(t){i.each(this.children,function(n){n.suspend(t)})},s.prototype.isScopedTo=function(t){var n=this;i.each(arguments,function(t){var r=n.scope&&n.scope.constructor===Object?n.scope[t]:n.scope;n.metadata.expression.push({p:"data."+t,v:r}),n.metadata.scope.push(t)})},s.prototype.replay=function(t){var n=this;n.pubsub.suspend(),i.each(t,function(t){n.handles[t.topic]&&n.handles[t.topic](t.data,t)}),n.pubsub.resume()},s.prototype.addHandler=e},{"./actor.addHandler":9,"./utils":21,"tribe.expressions":5}],11:[function(t,n,r){"undefined"==typeof Tribe&&(Tribe={}),Tribe.PubSub=t("./pubsub"),Tribe.PubSub.Actor=t("./actor")},{"./actor":10,"./pubsub":17}],12:[function(t,n,r){n.exports=function(n,r){function e(t,n){var e=t&&t.topic?t:{topic:t,data:n};return e.channelId=r,e}function i(t){return function(n,e){e.channelId===r&&t(n,e)}}var s=this,o=t("./lifetime");n=n.createLifetime(),this.id=r,this.owner=n.owner,this.publish=function(t,r){return n.publish(e(t,r))},this.publishSync=function(t,r){return n.publishSync(e(t,r))},this.subscribe=function(t,r){return n.subscribe(t,i(r))},this.subscribeOnce=function(t,r){return n.subscribeOnce(t,i(r))},this.unsubscribe=function(t){return n.unsubscribe(t)},this.end=function(){return n.end()},this.createLifetime=function(){return new o(s,s.owner)}}},{"./lifetime":15}],13:[function(t,n,r){var e=t("../utils");n.exports=function(t){var n={};return{add:function(t,r){n[r]=t},remove:function(t){delete n[t]},get:function(t){return e.values(n)}}}},{"../utils":21}],14:[function(t,n,r){var e=t("../utils"),i=t("tribe.expressions");n.exports=function s(t){function r(t,n,r){o[r.p]||(o[r.p]={});var e=o[r.p];e[r.v]||(e[r.v]={}),e[r.v][n]=t,u[n]=r}var o={},u={};this.add=function(e,i,s){if(!s)return[];if(s.constructor!==Array&&(s=[s]),0==s.length)return[];if(1===s.length)r(e,i,s[0]);else{var o=new n.exports(t);o.add(e,i,s.slice(1)),r(o,i,s[0])}},this.remove=function(t){var n=u[t];n&&(delete o[n.p][n.v][t],delete u[t])},this.get=function(t){if(!t.data)return[];var n=[];for(var r in o)if(o.hasOwnProperty(r))for(var u=i.evaluateKeyPath(r,t),c=e.values(o[r][u]),a=0,f=c.length;f>a;a++){var h=c[a];h.constructor===s?n=n.concat(h.get(t)):n.push(h)}return n}}},{"../utils":21,"tribe.expressions":5}],15:[function(t,n,r){var e=t("./channel"),i=t("./actor"),s=t("./utils"),o=t("tribe.expressions"),u=n.exports=function(t,n,r){function e(t){return s.isArray(t)?a=a.concat(t):a.push(t),t}function i(t,n){var e=t&&t.topic?t:{topic:t,data:n};return r&&(e.data||(e.data={}),s.each(r,function(t,n){e.data[n]=e.data[n]||t})),e}var c=this,a=[],f=!0;this.owner=n,this.publish=function(n,r){return f?t.publish(i(n,r)):void 0},this.publishSync=function(n,r){return f?t.publishSync(i(n,r)):void 0},this.subscribe=function(n,i,s){var u=o.combine(s,o.create(r,"data")),c=t.subscribe(n,i,u);return e(c)},this.subscribeOnce=function(n,r){var i=t.subscribeOnce(n,r);return e(i)},this.unsubscribe=function(n){return t.unsubscribe(n)},this.end=function(){return t.unsubscribe(a)},this.createLifetime=function(t){return new u(c,c.owner,s.extend({},r,t))},this.suspend=function(){f=!1},this.resume=function(){f=!0}};u.prototype.startActor=function(t,n){return new i(this,t).start(n)},u.prototype.channel=function(t){return new e(this,t)}},{"./actor":10,"./channel":12,"./utils":21,"tribe.expressions":5}],16:[function(t,n,r){var e=t("./utils");n.exports={sync:!1,handleExceptions:!0,exceptionHandler:function(t,n){"undefined"!=typeof console&&console.log("Exception occurred in subscriber to '"+n.topic+"': "+e.errorDetails(t))}}},{"./utils":21}],17:[function(t,n,r){var e=t("./lifetime"),i=t("./channel"),s=t("./actor"),o=t("./topicList"),u=t("./subscribeOnce"),c=t("./subscribeTo"),a=t("./options"),f=t("./utils"),h=n.exports=function(t){function n(t){function n(n){var r=i("exceptionHandler");if(i("handleExceptions")&&r)try{n(t.data,t)}catch(e){r(e,t)}else n(t.data,t)}for(var r=h.get(t),e=t.sync===!0||s.sync===!0,o=0,u=r.length;u>o;o++)e?n(r[o]):!function(t){setTimeout(function(){n(t)})}(r[o])}function r(t,n){return t&&t.topic?t:{topic:t,data:n}}function i(t){return s.options.hasOwnProperty(t)?s.options[t]:a[t]}var s=this;this.owner=this,this.options=t||{},this.sync=i("sync");var h=this.subscribers=new o;this.publish=function(t,e){return n(r(t,e))},this.publishSync=function(t,e){var i=r(t,e);return i.sync=!0,n(i)},this.subscribe=function(t,n,r){return"string"==typeof t?h.add(t,n,r):f.isArray(t)?f.map(t,function(t){return h.add(t,n,r)}):f.map(t,function(t,n){return h.add(n,t,r)})},this.subscribe.to=c(this),this.unsubscribe=function(t){if(f.isArray(t)){for(var n=[],r=0,e=t.length;e>r;r++)n.push(h.remove(t[r]));return n}return h.remove(t)},this.createLifetime=function(t){return new e(s,s,t)},this.subscribeOnce=u};h.prototype.channel=function(t){return new i(this,t)},h.prototype.startActor=function(t,n){return new s(this,t).start(n)}},{"./actor":10,"./channel":12,"./lifetime":15,"./options":16,"./subscribeOnce":18,"./subscribeTo":19,"./topicList":20,"./utils":21}],18:[function(t,n,r){n.exports=function(n,r){function e(){var t={};return u.each(n,function(n){t[n]=s(r)}),t}function i(){return u.map(n,function(t,n){return c.subscribe(n,s(t))})}function s(t){return function(){c.end(),t.apply(o,arguments)}}var o=this,u=t("./utils"),c=this.createLifetime();return"string"==typeof n?c.subscribe(n,s(r)):u.isArray(n)?c.subscribe(e()):c.subscribe(i())}},{"./utils":21}],19:[function(t,n,r){n.exports=function(t){return function(n){return{when:function(r){return{equals:function(e){return{execute:function(i){return t.subscribe(n,i,{p:r,v:e})}}}}},execute:function(r){return t.subscribe(n,r)}}}}},{}],20:[function(t,n,r){var e={"default":t("./filters/default"),expression:t("./filters/expression")};n.exports=function(){function t(t,n){if("*"===n)return!0;var r="^"+n.replace(/\./g,"\\.").replace(/\*/g,"[^.]*")+"$";return t.match(r)}var n={},r=-1;this.get=function(r){var e=r.topic,i=[];for(var s in n)if(n.hasOwnProperty(s)&&t(e,s))for(var o in n[s])n[s].hasOwnProperty(o)&&(i=i.concat(n[s][o].get(r)));return i},this.add=function(t,i,s){var o=(++r).toString(),u=s&&(s.constructor!==Array||s.length>0)?"expression":"default";n.hasOwnProperty(t)||(n[t]={});var c=n[t];return c[u]||(c[u]=new e[u](t)),c[u].add(i,o,s),o},this.remove=function(t){for(var r in n)if(n.hasOwnProperty(r))for(var e in n[r])n[r].hasOwnProperty(e)&&n[r][e].remove(t)}}},{"./filters/default":13,"./filters/expression":14}],21:[function(t,n,r){var e=n.exports={};e.isArray=function(t){return t.constructor===Array},e.copyProperties=function(t,n,r){for(var e=0,i=r.length;i>e;e++){var s=r[e];t.hasOwnProperty(s)&&(n[s]=t[s])}},e.errorDetails=function(t){return t?t.constructor===String?t:(t.stack||"")+(t.inner?"\n\n"+e.errorDetails(t.inner):"\n"):""};var i=Array.prototype.forEach,s=Array.prototype.map,o={};e.each=function(t,n,r){if(null!=t)if(i&&t.forEach===i)t.forEach(n,r);else if(t.length===+t.length){for(var e=0,s=t.length;s>e;e++)if(n.call(r,t[e],e,t)===o)return}else for(var u in t)if(t.hasOwnProperty(u)&&n.call(r,t[u],u,t)===o)return},e.map=function(t,n,r){var i=[];return null==t?i:s&&t.map===s?t.map(n,r):(e.each(t,function(t,e,s){i[i.length]=n.call(r,t,e,s)}),i)},e.extend=function(t,n){for(var r=Array.prototype.slice.call(arguments),i=1,s=r.length;s>i;i++)e.each(r[i],function(n,r){t[r]=n});return t},e.keys=function(t){var n=[];for(var r in t)t.hasOwnProperty(r)&&n.push(r);return n},e.values=function(t){var n=[];for(var r in t)t.hasOwnProperty(r)&&n.push(t[r]);return n}},{}]},{},[11]);
