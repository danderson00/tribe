module('Integration.Scope', { setup: Test.Integration.pubsubAsTribe });

test("pane is scoped to value specified in pane options", function () {
    T.createNode('#qunit-fixture', { path: 'Scope/child', scope: { value: 'test' } });
    var pubsub = T.nodeFor('#count').pane.pubsub,
        rootPubsub = pubsub.owner;

    // pubsub is the pane's pubsub, publishing is scoped too
    pubsub.publish('topic');
    equal($('#count').text(), '1');
    equal($('#totalCount').text(), '1');

    // using top level, unscoped pubsub
    rootPubsub.publish('topic');
    equal($('#count').text(), '1');
    equal($('#totalCount').text(), '2');

    rootPubsub.publish('topic', { value: 'test' });
    equal($('#count').text(), '2');
    equal($('#totalCount').text(), '3');

    // outside of current scope
    pubsub.publish('topic', { value: 'test2' });
    equal($('#count').text(), '2');
    equal($('#totalCount').text(), '4');
});

// test("pane is scoped to value specified in binding handler", function () {
//     T.createNode('#qunit-fixture', { path: 'Scope/middle' });
//     var pubsub = T.nodeFor('#count').pane.pubsub.owner;
//
//     pubsub.publish('topic');
//     equal($('#count').text(), '0');
//
//     pubsub.publish('topic', { value2: 'test2' });
//     equal($('#count').text(), '1');
// });
//
// test("scope cascades through panes", function () {
//     T.createNode('#qunit-fixture', { path: 'Scope/parent' });
//     var pubsub = T.nodeFor('#count').pane.pubsub.owner;
//
//     pubsub.publish('topic');
//     equal($('#count').text(), '0');
//
//     pubsub.publish('topic', { value: 'test' });
//     equal($('#count').text(), '0');
//
//     pubsub.publish('topic', { value2: 'test2' });
//     equal($('#count').text(), '0');
//
//     pubsub.publish('topic', { value: 'test', value2: 'test2' });
//     equal($('#count').text(), '1');
// });
