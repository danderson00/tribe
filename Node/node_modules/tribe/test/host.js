var options = require('tribe/options'),
    process = require('tribe/process'),
    watcher = require('tribe/utilities/watcher'),
    runner;

module.exports = {
    start: function () {
        // need to delay this as it won't be initialised yet. A bit nasty.
        var test = require('tribe/test');

        // test channel should be an option
        runner = process.start('./client', '__test', options.test.debugPort);

        watcher.watch(options.testPath, {
            createOrUpdate: function (changePath) {
                test.loadFile(changePath, changePath.replace(options.testPath, ''));
            },
            'delete': function (deletePath) {
                test.removeFile(deletePath);
            }
        });

        //watcher.watch(sourceFolder, {
        //    //update: function (changePath) {
        //    //    utils.clearCache(changePath);
        //    //}
        //});
    }
};