var pubsub = require('tribe/pubsub'),
    process = require('tribe/process');

suite('tribe.process', function () {
    var child, token;

    teardown(function () {
        if(child) child.end();
        if (token) pubsub.unsubscribe(token);
        child = undefined;
        token = undefined;
    });

    test("child process publishes messages to message bus", function (done) {
        token = pubsub.subscribe('test', done);
        child = process.start('process/child');
    });

    test("channel messages are published to child message bus", function (done) {
        token = pubsub.subscribe('fromChild', done);
        child = process.start('process/child', 'test');
        pubsub.publishSync({ topic: 'fromParent', channelId: 'test' });
    });

    // add tests for path relative to calling module

    // add tests for channels

    // add tests for logging / stdin/out handling
});