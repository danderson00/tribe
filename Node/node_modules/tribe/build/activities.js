var resources = require('tribe/utilities/files'),
    path = require('path'),
    fs = require('fs'),
    _ = require('underscore'),
    factories = {};

module.exports = {
    register: function (name, factory) {
        factories[name] = factory;
    },
    createTask: function (spec) {
        if (!factories[spec.activity])
            throw new Error("The activity '" + spec.activity + "' has not been registered.");
        return factories[spec.activity](spec.options);
    }, 
    loadBuiltin: function () {
        _.each(fs.readdirSync(path.resolve(__dirname, 'activities')), function (filename) {
            require('./activities/' + filename);
        });
    }
};